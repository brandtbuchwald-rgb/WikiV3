<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EHT Companion Hub</title>

  <!-- Base styles (light mode default) -->
  <style>
    /* Page + typography */
    body {
      background: #ffffff;
      color: #222;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      transition: background .3s, color .3s;
    }
    a { color: #1565c0; }

    /* Sidebar look */
    .sidebar { background: #f5f5f5; transition: background .3s; position: relative; }
    .sidebar-nav { padding: 10px; }
    .sidebar-nav a { color: #222; text-decoration: none; }
    .sidebar-nav a:hover { color: #1565c0; }

    /* Collapsible indicators */
    .sidebar-nav li.collapsible > .collapsible-label::after {
      content: "‚ñ∏";
      float: right;
      opacity: .6;
    }
    .sidebar-nav li.open.collapsible > .collapsible-label::after {
      content: "‚ñæ";
    }
    .sidebar-nav li.open > ul { display: block; }
    .sidebar-nav li ul { display: none; padding-left: 15px; }

    /* Theme toggle button (docked in sidebar header) */
    .theme-toggle{
      position: absolute;
      top: 10px;
      right: 12px;
      background: rgba(0,0,0,0.06);
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 18px;
      transition: background .3s;
      z-index: 3;
    }
    .theme-toggle:hover { background: rgba(0,0,0,0.12); }

    /* DARK THEME */
    body.dark { background: #1e252f; color: #e0e0e0; }
    body.dark a { color: #4da3ff; }
    body.dark .sidebar { background: #141a23; }
    body.dark .sidebar-nav a { color: #cfd8dc; }
    body.dark .sidebar-nav a:hover { color: #ffffff; }
    body.dark .theme-toggle { background: rgba(255,255,255,0.10); }
    body.dark .theme-toggle:hover { background: rgba(255,255,255,0.20); }
 
  </style>
  <!-- Docsify Themeable CSS (provides the layout/positioning for the sidebar) -->
<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/docsify-themeable@0/dist/css/theme-simple.css">
</head>
<body>
  <div id="app">Loading EHT Companion Hub‚Ä¶</div>
  <!-- Toggle will be moved into the sidebar by JS after Docsify mounts -->
  <button id="themeBtn" class="theme-toggle" aria-label="Toggle theme">üåô</button>

  <script>
    // ===================== Docsify config =====================
    window.$docsify = {
      name: 'EHT Companion Hub',
      loadSidebar: true,
      subMaxLevel: 2,
      auto2top: true,
      search: 'auto',

      // Collapsible sections + keep "Home" open and non-collapsible
      plugins: [
        function (hook, vm) {
          hook.doneEach(function () {
            const nav = document.querySelector('.sidebar-nav');
            if (!nav) return;

            // Make groups collapsible, but lock Home open
            nav.querySelectorAll('li').forEach((li) => {
              const sub = li.querySelector(':scope > ul');
              if (!sub) return;

              if (li.textContent.trim().startsWith('Home')) {
                li.classList.add('open');
                li.classList.remove('collapsible');
                return; // skip toggling behavior for Home
              }

              li.classList.add('collapsible');
              const label = li.querySelector(':scope > a, :scope > p, :scope > span');
              if (!label) return;
              if (!li._boundToggle) {
                label.classList.add('collapsible-label');
                label.addEventListener('click', (e) => {
                  // If it's a link, prevent nav and just toggle the group
                  if (label.tagName.toLowerCase() === 'a') e.preventDefault();
                  li.classList.toggle('open');
                });
                li._boundToggle = true;
              }
            });

            // Dock the theme toggle into the sidebar so it slides with it
            const sidebar = document.querySelector('.sidebar');
            const btn = document.getElementById('themeBtn');
            if (sidebar && btn && !sidebar.contains(btn)) {
              sidebar.appendChild(btn);
            }
          });
        }
      ]
    };

    // ===================== Theme toggle (persisted) =====================
    const themeBtn = document.getElementById('themeBtn');

    function updateThemeIcon() {
      themeBtn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    }
    function applySavedTheme() {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') document.body.classList.add('dark');
      updateThemeIcon();
    }
    function toggleTheme() {
      document.body.classList.toggle('dark');
      localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
      updateThemeIcon();
    }
    themeBtn.addEventListener('click', toggleTheme);
    applySavedTheme();
  </script>

  <!-- Docsify + search plugin -->
  <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
</body>
</html>
