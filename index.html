<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>EHT Companion Hub</title>

    <!-- themeable styles (light + dark) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify-themeable@0/dist/css/theme-simple.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify-themeable@0/dist/css/theme-simple-dark.css" id="darkTheme">

    <style>
      :root{ --theme-color:#3F51B5; }
      /* Fixed theme toggle (stays out of the drawer) */
      .theme-toggle{
        position:fixed; top:8px; right:12px; z-index:10000;
        border:1px solid var(--mono-tint2); border-radius:10px;
        background:transparent; padding:.35rem .55rem; font-size:18px;
      }
      /* Sidebar polish */
      .sidebar{ width:280px; }
      .sidebar .search input{ border-radius:10px; }
      .sidebar-nav a{ font-size:15px; line-height:1.35; }
    </style>
  </head>
  <body>
    <div id="app">Loading EHT Companion Hub‚Ä¶</div>
    <button id="themeBtn" class="theme-toggle" aria-label="Toggle theme">üåô/‚òÄÔ∏è</button>

    <script>
      // ===== Docsify config (point straight at /WikiV3/) =====
      window.$docsify = {
        name: 'EHT Companion Hub',
        repo: 'brandtbuchwald-rgb/WikiV3',
        loadSidebar: true,
        basePath: '/WikiV3/',     // <‚Äî key line: find _sidebar.md here
        subMaxLevel: 2,
        search: 'auto',
        routerMode: 'hash',
        auto2top: true,
        plugins: [
          function(hook, vm){
            hook.doneEach(function(){
              // Auto-close drawer on link tap (mobile)
              document.querySelectorAll('.sidebar-nav a').forEach(a=>{
                a.addEventListener('click', ()=> document.body.classList.add('close'));
              });
            });
          }
        ]
      };

      // ===== Theme toggle (persist) =====
      const KEY='eht-theme';
      const setTheme=t=>{
        document.documentElement.setAttribute('data-theme', t==='dark'?'dark':'light');
        localStorage.setItem(KEY,t);
        document.getElementById('darkTheme').disabled=(t!=='dark');
      };
      setTheme(localStorage.getItem(KEY) || (matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light'));
      document.getElementById('themeBtn').onclick=()=>setTheme(localStorage.getItem(KEY)==='dark'?'light':'dark');

      // ===== Swipe from left edge to open drawer =====
      (function(){
        let sx=null,sy=null; const EDGE=24;
        addEventListener('touchstart',e=>{sx=e.touches[0].clientX; sy=e.touches[0].clientY;},{passive:true});
        addEventListener('touchend',e=>{
          if(sx===null) return;
          const dx=e.changedTouches[0].clientX-sx, dy=Math.abs(e.changedTouches[0].clientY-sy);
          if(sx<EDGE && dx>50 && dy<40) document.body.classList.remove('close');
          sx=sy=null;
        },{passive:true});
      })();
    </script>

    <!-- Docsify -->
    <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
  </body>
</html>
